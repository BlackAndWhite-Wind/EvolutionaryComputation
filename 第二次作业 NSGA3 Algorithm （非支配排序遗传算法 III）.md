### 第二次作业 NSGA3 Algorithm （非支配排序遗传算法 III）

#### 背景

​      $NSGA3$ 算法是从 $NSGA2$ 算法加以改进所得到的。在之前的算法中，优化的目标往往只有 $1$ 或者 $2$ 个，这使得 $NSGA2$ 解决这些问题游刃有余。下面简述一下 $NSGA2$ 算法基于第一代的改进之处：

- 在第一代的基础上提出了快速非支配排序算法，一方面降低了计算的复杂度，另一方面它将父代种群跟子代种群进行合并，使得下一代的种群从双倍的空间中进行选取，从而保留了最为优秀的所有个体；
- 引进精英策略，保证某些优良的种群个体在进化过程中不会被丢弃，从而提高了优化结果的精度；
- 采用拥挤度和拥挤度比较算子，不但克服了 $NSGA$ 中需要人为指定共享参数的缺陷，而且将其作为种群中个体间的比较标准，使得准 $Pareto$ 域中的个体能均匀地扩展到整个 $Pareto$ 域，保证了种群的多样性。

   到目前，随着时代的发展，优化目标往往不只有一两个，而是有四个以上。针对这样的高维目标空间，主要是要解决以下三个方面：

- 随着优化目标数量的增加，非支配解在种群中的比例也在增加，因而会导致搜索过程缓慢；
- 对于高维目标空间，维持多样性的指标计算复杂度过高，解的邻近元素寻找困难；
- 对于高维目标空间，重组算子的搜索能力过于低效了；     

​    因此，在原有算法的基础上，引入了**参考点**这个概念，因此 $NSGA3$ 算法便诞生了。

​    论文链接：[luis ariza](https://ieee-dataport.org/authors/luis-ariza) Last updated:Mon, 11/18/2019 - 13:30 DOI: [10.21227/f5g3-0088](https://dx.doi.org/10.21227/f5g3-0088)



#### 简介

​     $NSGA3$ 算法引入了**参考点**的概念。利用**分布参考点**在高维目标下来维持种群的多样性。当面对三个及以上的多目标优化问题时，如果继续采用拥挤距离的话，$NSGA2$ 算法的收敛性和多样性会不好，容易陷入局部最优。

- **参考点**：出自 $1998$ 年 $Das$ 和 $Dennis$ 在1998年提出的边界交叉构造权重的方法。

- **构造参考点**：在标准化参考平面上，维数是 $m$， 如果每一维目标被均匀地分割成 $p$ 份，那么会均匀地产生 $C_{m+p-1}^{p} $ 个参考点。

  <img src="https://img-blog.csdn.net/20180801174548696?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTUxMjM1MA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="img" style="zoom:80%;" />

  <img src="https://pic2.zhimg.com/v2-590c83207af0d358196520631b140c69_r.jpg" alt="preview" style="zoom:50%;" />

- **引入参考点的目的**：就是为了获取种群个体与响应参考点之间的映射关系（即垂直距离），进而使得种群超更接近参考点的方向进化，进而事参考点的分布更加均匀。

- **规范化目标函数**：

  - 以最小化为例，首先得到种群 $S_t$ 中的所有个体在每一维目标上的最小值，构成当前种群的理想点。
  - 将所有个体的目标值，以及理想点以此理想点为参考作转换操作，这时理想点变为原点，个体的目标值为转换后的临时标准化目标值。
  - 然后计算每一维目标轴上的极值点，这 $M$ 个极值点组成了 $M-1$ 维的线性超平面，这时可以计算出各个目标方向上的截距。然后利用截距和临时的标准化目标值计算真正的标准化目标值。
  - 计算公式：$f_{i}^{n}(x)=\frac{f_{i}(x)-z_{i}^{min}}{a_i-z_{i}^{min}} ,i\in [1,m]$ ，其中 $a_i$ 是截距。

- **关联操作**：在设置完参考点之后，要进行关联操作，我们要让种群中的个体分别关联到相应的参考点。为了这个目的，我们定义一个参考线，它是原点与参考点在目标空间的连线。有了参考线后，我们计算种群 $S_t$ 的每个个体到参考线的垂直距离。然后个体与和它最近的参考线关联起来。

  

#### 算法流程详解

- 我们假设 $P_t$ 是第 $t$ 代的父代，记录大小为 $N$，则 $P_t$ 所产生的子代我们设置为 $Q_t$ ，大小也为 $N$。

  1. 我们设置一个结合的代（子代和父代结合） $R_t=P_t \cup Q_t$，在 $2N$ 的大小中选出 $N$ 个个体。
  2. 我们得到了 $R_t$，利用非支配排序分为多个非支配层 $(F_1,F_2,F_3...,F_n)$。
  3. 枚举每一个 $F_i$​，从 $F_i$ 开始构造一个新的种群 $S_t$ 。
  4. 判断：如果 $S_{t}.size()==N$，则继续，如果 $S_t.size()<N$，那么继续寻找下一个非支配层，直到首次大于 $N$。

- **总体流程**

  **输**入：$H$ 参考点 $Z^{s}$ 或者用户提供的参考点 $Z^{\alpha}$， 父代种群 **$P_t$** ，种群大小为 $N$ 。

  **输出**：$P_{t+1}$。

  **算法步骤：**

  1. 设置归档集 $S_t=\emptyset $ ，$i=1$。
  2. 通过交叉变异得到了子代种群 $Q_t$ 。
  3. 我们设置一个结合的代（子代和父代结合） $R_t=P_t \cup Q_t$ 。
  4. 对 $R_t$ 进行非支配排序划分成若干支配层 $F_i,i \in [1,m]$。
  5. $if(\left | S_t \right |<N), then$ 执行 $6,7$ 步。
  6. 将优先级高的非支配层存入 $S_t$ 中，$i++$。
  7. 把临界层设置为 $F_l=F_i$。
  8. $if(\left | S_t \right |==N)$ ：
  9. $P_{t+1}=S_t$。退出循环 $break$。
  10. $else$ ：
      11. $P_{t+1} = \cup _{j=1}^{l-1}F_j$
      12. 从 $F_t$ 中选择 $k$ 个个体，其中 $k=N-\left | P_{t+1} \right | $。
      13. 标准化目标空间，并设置参考向量 $Z^{t}$。
      14. 种群与参考点的关联操作。
      15. 计算参考向量所关联个体的数目。
      16. 从 $F_t$ 中选择 $k$ 个个体进入 $P_{t+1}$。

​         17. $endif$



#### 图和表格表示结果

![image-20220516195349867](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20220516195349867.png)



![image-20220516195446898](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20220516195446898.png)